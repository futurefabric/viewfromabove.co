<section class="gallery">
<ul class="tweets">

<% 
counter = 0
images_per_page = 24
last_id = ''
%>

<% @tweets.each do |tweet|

tweet_media = tweet.attrs[:entities][:media]

	if counter < images_per_page

		if tweet_media != nil
			id_str = tweet.attrs[:id].to_s
			blacklisted = blacklisted_tweet_ids(id_str)
			
			if blacklisted != true

				# we can show the tweet! it has media and isn't blacklisted :)
				# increment the counter
				counter += 1

				image_path = tweet_media.first[:media_url]
				tweet_id = tweet.attrs[:id].to_s
				status_link = "https://twitter.com/Cmdr_Hadfield/status/" + tweet_id

%>

<li>
	<a href="<%= status_link %>" target="_blank">
		<div class="aspectwrapper">
		<div class="tweet_media" style="background:url('<%= image_path %>') no-repeat; background-position: -2px -2px; background-size: 101% 101%;">
			<div class="tweet">
				<p><%= tweet.attrs[:text] %><br />
				<span class="dated"><% t = Time.parse(tweet.attrs[:created_at]) %>
					<%= t.day %> <%= Date::MONTHNAMES[t.month] %>, <%= t.year %></span></p>
				<!-- 
				<br />
				Retweets: <%= tweet.attrs[:retweet_count] %><br />
				Favourited: <%= tweet.attrs[:favorite_count] %> times<br/>
				Dated: <%= tweet.attrs[:created_at] %><br/> 
				-->
			</div>
		</div>
		</div>
	</a>
</li>

			<% end %>
		<% end %>
	<% end

	if counter == images_per_page
		last_id = tweet.attrs[:id].to_s
		break
	end

	%>
<% end %>
</ul>
</section>

<section class="pagination">
<p><%= link_to('â—€ Older photos', root_path + 'from/' + last_id) %></p>
</section>

